{
  "hash": "4775e3321d20f214bd39a4d7915da878",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Financial Time Series Models\"\nformat:\n  html:\n    code-fold: true\n    toc: true\n    toc-depth: 3\n    embed-resources: true\n---\n\n\n\n# Theoretical Framework\n\n## Overview\n\nHaving established the relationship between NBA performance and betting markets, we now shift our focus to the financial behavior of sports betting stocks themselves. In this chapter, these firms are treated as an independent financial ecosystem shaped by sports events, regulatory changes, and broader market forces. Financial returns exhibit volatility clustering, where periods of high or low volatility tend to persist. Because ARIMA models assume constant variance, they are not well suited for data with this property. GARCH models address this limitation by explicitly capturing time-varying volatility. The key insight is that while returns may be unpredictable due to market efficiency, volatility often follows predictable patterns that are essential for risk management, options pricing, and portfolio optimization.\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(forecast)\nlibrary(astsa)\nlibrary(xts)\nlibrary(tseries)\nlibrary(fpp2)\nlibrary(fma)\nlibrary(lubridate)\nlibrary(TSstudio)\nlibrary(quantmod)\nlibrary(tidyquant)\nlibrary(plotly)\nlibrary(imputeTS)\nlibrary(dplyr)\nlibrary(reshape2)\nlibrary(gridExtra)\nlibrary(zoo)\nlibrary(kableExtra)\nlibrary(vars)\nlibrary(patchwork)\nlibrary(moments)\nlibrary(fGarch)\n\ntheme_set(theme_minimal(base_size = 12))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load all stock data\ndkng <- read_csv(\"data/financial/DKNG_daily.csv\", show_col_types = FALSE)\ncolnames(dkng) <- gsub(\"Adj Close\", \"Adj_Close\", colnames(dkng))\ndkng <- dkng %>%\n    mutate(Date = as.Date(Date)) %>%\n    arrange(Date)\n\npenn <- read_csv(\"data/financial/PENN_daily.csv\", show_col_types = FALSE)\ncolnames(penn) <- gsub(\"Adj Close\", \"Adj_Close\", colnames(penn))\npenn <- penn %>%\n    mutate(Date = as.Date(Date)) %>%\n    arrange(Date)\n\nczr <- read_csv(\"data/financial/CZR_daily.csv\", show_col_types = FALSE)\ncolnames(czr) <- gsub(\"Adj\\\\.Close\", \"Adj_Close\", colnames(czr))\n\nif (\"Adj_Close\" %in% colnames(czr)) {\n    czr$Adj_Close <- as.numeric(czr$Adj_Close)\n}\nczr <- czr %>%\n    mutate(Date = as.Date(Date)) %>%\n    arrange(Date)\n\nmgm <- read_csv(\"data/financial/MGM_daily.csv\", show_col_types = FALSE)\ncolnames(mgm) <- gsub(\"Adj\\\\.Close\", \"Adj_Close\", colnames(mgm))\n\nif (\"Adj_Close\" %in% colnames(mgm)) {\n    mgm$Adj_Close <- as.numeric(mgm$Adj_Close)\n}\nmgm <- mgm %>%\n    mutate(Date = as.Date(Date)) %>%\n    arrange(Date)\n```\n:::\n\n\n\n## Calculate Returns\n\nFinancial time series models typically work with **returns** rather than prices. So, we calculate **log returns** (continuously compounded):\n\n$$\nr_t = \\ln(P_t) - \\ln(P_{t-1}) = \\ln\\left(\\frac{P_t}{P_{t-1}}\\right)\n$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate log returns for all stocks\ndkng$LogReturn <- c(NA, diff(log(dkng$Adj_Close)))\ndkng$Return_Pct <- dkng$LogReturn * 100\ndkng$Ticker <- \"DKNG\"\ndkng <- dkng %>% filter(!is.na(LogReturn))\n\npenn$LogReturn <- c(NA, diff(log(penn$Adj_Close)))\npenn$Return_Pct <- penn$LogReturn * 100\npenn$Ticker <- \"PENN\"\npenn <- penn %>% filter(!is.na(LogReturn))\n\nczr$LogReturn <- c(NA, diff(log(czr$Adj_Close)))\nczr$Return_Pct <- czr$LogReturn * 100\nczr$Ticker <- \"CZR\"\nczr <- czr %>% filter(!is.na(LogReturn))\n\nmgm$LogReturn <- c(NA, diff(log(mgm$Adj_Close)))\nmgm$Return_Pct <- mgm$LogReturn * 100\nmgm$Ticker <- \"MGM\"\nmgm <- mgm %>% filter(!is.na(LogReturn))\n\n# Summary statistics for all stocks\nstocks_list <- list(\n    DKNG = dkng$Return_Pct,\n    PENN = penn$Return_Pct,\n    CZR = czr$Return_Pct,\n    MGM = mgm$Return_Pct\n)\n\ncat(\"\\n=== RETURNS SUMMARY STATISTICS ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== RETURNS SUMMARY STATISTICS ===\n```\n\n\n:::\n\n```{.r .cell-code}\nfor (ticker in names(stocks_list)) {\n    returns <- stocks_list[[ticker]]\n    cat(ticker, \":\\n\")\n    cat(\"  Mean:\", round(mean(returns), 4), \"%\\n\")\n    cat(\"  Std Dev:\", round(sd(returns), 4), \"%\\n\")\n    cat(\"  Min:\", round(min(returns), 4), \"%\\n\")\n    cat(\"  Max:\", round(max(returns), 4), \"%\\n\")\n    cat(\"  Skewness:\", round(moments::skewness(returns), 4), \"\\n\")\n    cat(\"  Kurtosis:\", round(moments::kurtosis(returns), 4), \"\\n\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDKNG :\n  Mean: 0.0638 %\n  Std Dev: 4.2354 %\n  Min: -32.6061 %\n  Max: 15.9306 %\n  Skewness: -0.3807 \n  Kurtosis: 7.8417 \n\nPENN :\n  Mean: -0.022 %\n  Std Dev: 4.9443 %\n  Min: -59.4142 %\n  Max: 29.8592 %\n  Skewness: -1.7046 \n  Kurtosis: 30.3981 \n\nCZR :\n  Mean: -0.0718 %\n  Std Dev: 4.5517 %\n  Min: -47.0084 %\n  Max: 36.5733 %\n  Skewness: -0.9193 \n  Kurtosis: 21.3669 \n\nMGM :\n  Mean: -0.0042 %\n  Std Dev: 3.4071 %\n  Min: -40.9684 %\n  Max: 28.6042 %\n  Skewness: -0.9679 \n  Kurtosis: 26.9113 \n```\n\n\n:::\n:::\n\n\n\n---\n\n# Data Visualization & Stationarity\n\n::: {.panel-tabset}\n\n## DraftKings (DKNG)\n\n::: {.panel-tabset}\n\n### Price & Returns Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(dkng, aes(x = Date, y = Adj_Close)) +\n    geom_line(color = \"#006bb6\", linewidth = 0.8) +\n    labs(\n        title = \"DraftKings (DKNG) Stock Price\",\n        subtitle = \"Daily Adjusted Close Price\",\n        x = \"Date\", y = \"Price ($)\"\n    ) +\n    theme_minimal()\n\np2 <- ggplot(dkng, aes(x = Date, y = Return_Pct)) +\n    geom_line(color = \"darkred\", linewidth = 0.5, alpha = 0.7) +\n    geom_hline(yintercept = 0, linetype = \"dashed\", color = \"black\") +\n    labs(\n        title = \"DraftKings (DKNG) Daily Returns\",\n        subtitle = \"Log returns showing volatility clustering\",\n        x = \"Date\", y = \"Return (%)\"\n    ) +\n    theme_minimal()\n\np1 / p2\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/dkng-price-returns-1.png){width=1152}\n:::\n:::\n\n\n\n**Observations**:\n\n- **Price Series**: Non-stationary with clear trends. DKNG went public via SPAC merger in 2020, experienced a pandemic boom, then declined as competition intensified.\n- **Returns Series**: Appears stationary around zero mean, but exhibits clear **volatility clustering**. Periods of calm (2021-early 2022) alternate with turbulence (late 2022, 2024).\n\n### Volatility Clustering\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate rolling volatility (20-day window)\ndkng <- dkng %>%\n    arrange(Date) %>%\n    mutate(\n        Roll_Vol_20 = zoo::rollapply(Return_Pct, width = 20, FUN = sd, fill = NA, align = \"right\"),\n        Abs_Return = abs(Return_Pct)\n    )\n\np3 <- ggplot(dkng, aes(x = Date, y = Abs_Return)) +\n    geom_line(color = \"purple\", alpha = 0.6) +\n    labs(\n        title = \"Absolute Returns (Proxy for Volatility)\",\n        x = \"Date\", y = \"|Return| (%)\"\n    ) +\n    theme_minimal()\n\np4 <- ggplot(dkng, aes(x = Date, y = Roll_Vol_20)) +\n    geom_line(color = \"darkgreen\", linewidth = 0.8) +\n    labs(\n        title = \"20-Day Rolling Volatility\",\n        x = \"Date\", y = \"Volatility (% std dev)\"\n    ) +\n    theme_minimal()\n\np3 / p4\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/dkng-volatility-cluster-1.png){width=1152}\n:::\n:::\n\n\n\n**Volatility Clustering Evidence**:\n\nThe rolling volatility plot clearly shows time-varying variance. Volatility is not constant it rises sharply during market stress and falls during stable periods. This visual evidence motivates GARCH modeling.\n\n### ACF/PACF Analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ACF/PACF of returns\npar(mfrow = c(1, 2))\nacf(dkng$Return_Pct, lag.max = 30, main = \"ACF: DKNG Returns\")\npacf(dkng$Return_Pct, lag.max = 30, main = \"PACF: DKNG Returns\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/dkng-acf-returns-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ACF/PACF of squared returns (test for ARCH effects)\npar(mfrow = c(1, 2))\nacf(dkng$Return_Pct^2, lag.max = 30, main = \"ACF: Squared Returns (DKNG)\")\npacf(dkng$Return_Pct^2, lag.max = 30, main = \"PACF: Squared Returns (DKNG)\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/dkng-acf-squared-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n\n\n**Key Findings**:\n\n- **Returns ACF/PACF**: Minimal autocorrelation at most lags (consistent with weak-form market efficiency). Returns themselves are largely unpredictable.\n- **Squared Returns ACF/PACF**: **Strong autocorrelation** at multiple lags. This is the signature of ARCH effects while returns are unpredictable, volatility is highly predictable and persistent.\n  \n### Stationarity Tests\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ADF test on returns\nadf_dkng <- adf.test(dkng$Return_Pct)\n\ncat(\"=== Augmented Dickey-Fuller Test ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== Augmented Dickey-Fuller Test ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Null Hypothesis: Series has a unit root (non-stationary)\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNull Hypothesis: Series has a unit root (non-stationary)\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"ADF Statistic:\", round(adf_dkng$statistic, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nADF Statistic: -10.1901 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"p-value:\", round(adf_dkng$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\np-value: 0.01 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Conclusion:\", ifelse(adf_dkng$p.value < 0.05,\n    \"Reject H0 - Returns are STATIONARY\",\n    \"Fail to reject H0 - Returns are NON-STATIONARY\"\n), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConclusion: Reject H0 - Returns are STATIONARY \n```\n\n\n:::\n:::\n\n\n\n**Stationarity Conclusion**: The ADF test confirms that DKNG returns are stationary (p < 0.01). This validates our use of returns rather than prices and confirms that we don't need differencing in the mean equation.\n\n:::\n\n---\n\n## Penn Entertainment (PENN)\n\n::: {.panel-tabset}\n\n### Price & Returns Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np5 <- ggplot(penn, aes(x = Date, y = Adj_Close)) +\n    geom_line(color = \"#006bb6\", linewidth = 0.8) +\n    labs(\n        title = \"Penn Entertainment (PENN) Stock Price\",\n        subtitle = \"Daily Adjusted Close Price\",\n        x = \"Date\", y = \"Price ($)\"\n    ) +\n    theme_minimal()\n\np6 <- ggplot(penn, aes(x = Date, y = Return_Pct)) +\n    geom_line(color = \"darkred\", linewidth = 0.5, alpha = 0.7) +\n    geom_hline(yintercept = 0, linetype = \"dashed\", color = \"black\") +\n    labs(\n        title = \"Penn Entertainment (PENN) Daily Returns\",\n        subtitle = \"Log returns showing volatility clustering\",\n        x = \"Date\", y = \"Return (%)\"\n    ) +\n    theme_minimal()\n\np5 / p6\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/penn-price-returns-1.png){width=1152}\n:::\n:::\n\n\n\n**Observations**:\n\n- **Price Series**: Even more volatile than DKNG. PENN's business model shifted from Barstool Sports (2020-2023) to ESPN BET (2023-present), creating structural breaks and extreme volatility.\n- **Returns Series**: Strong volatility clustering with several extreme spikes. This suggests PENN may exhibit even stronger GARCH effects than DKNG.\n\n### Volatility Clustering\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenn <- penn %>%\n    arrange(Date) %>%\n    mutate(\n        Roll_Vol_20 = zoo::rollapply(Return_Pct, width = 20, FUN = sd, fill = NA, align = \"right\"),\n        Abs_Return = abs(Return_Pct)\n    )\n\np7 <- ggplot(penn, aes(x = Date, y = Abs_Return)) +\n    geom_line(color = \"purple\", alpha = 0.6) +\n    labs(\n        title = \"Absolute Returns (Proxy for Volatility)\",\n        x = \"Date\", y = \"|Return| (%)\"\n    ) +\n    theme_minimal()\n\np8 <- ggplot(penn, aes(x = Date, y = Roll_Vol_20)) +\n    geom_line(color = \"darkgreen\", linewidth = 0.8) +\n    labs(\n        title = \"20-Day Rolling Volatility\",\n        x = \"Date\", y = \"Volatility (% std dev)\"\n    ) +\n    theme_minimal()\n\np7 / p8\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/penn-volatility-cluster-1.png){width=1152}\n:::\n:::\n\n\n\n### ACF/PACF Analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\nacf(penn$Return_Pct, lag.max = 30, main = \"ACF: PENN Returns\")\npacf(penn$Return_Pct, lag.max = 30, main = \"PACF: PENN Returns\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/penn-acf-returns-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\nacf(penn$Return_Pct^2, lag.max = 30, main = \"ACF: Squared Returns (PENN)\")\npacf(penn$Return_Pct^2, lag.max = 30, main = \"PACF: Squared Returns (PENN)\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/penn-acf-squared-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n\n\n**Key Findings**:\n\nSimilar to DKNG: returns show weak autocorrelation, but squared returns exhibit strong autocorrelation, indicating ARCH effects. The PACF of squared returns shows significant spikes at early lags, suggesting GARCH(1,1) may be appropriate.\n\n### Stationarity Tests\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadf_penn <- adf.test(penn$Return_Pct)\n\ncat(\"=== Augmented Dickey-Fuller Test ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== Augmented Dickey-Fuller Test ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"ADF Statistic:\", round(adf_penn$statistic, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nADF Statistic: -10.6554 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"p-value:\", round(adf_penn$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\np-value: 0.01 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Conclusion:\", ifelse(adf_penn$p.value < 0.05,\n    \"Reject H0 - Returns are STATIONARY\",\n    \"Fail to reject H0 - Returns are NON-STATIONARY\"\n), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConclusion: Reject H0 - Returns are STATIONARY \n```\n\n\n:::\n:::\n\n\n\n:::\n\n## Caesars Entertainment (CZR)\n\n::: {.panel-tabset}\n\n### Price & Returns\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_czr1 <- ggplot(czr, aes(x = Date, y = Adj_Close)) +\n    geom_line(color = \"#006bb6\", linewidth = 0.8) +\n    labs(\n        title = \"Caesars Entertainment (CZR) Stock Price\",\n        x = \"Date\", y = \"Price ($)\"\n    ) +\n    theme_minimal()\n\np_czr2 <- ggplot(czr, aes(x = Date, y = Return_Pct)) +\n    geom_line(color = \"darkred\", linewidth = 0.5, alpha = 0.7) +\n    geom_hline(yintercept = 0, linetype = \"dashed\", color = \"black\") +\n    labs(\n        title = \"Caesars Entertainment (CZR) Daily Returns\",\n        x = \"Date\", y = \"Return (%)\"\n    ) +\n    theme_minimal()\n\np_czr1 / p_czr2\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/czr-price-returns-1.png){width=1152}\n:::\n:::\n\n\n\n### Volatility & ACF\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nczr <- czr %>%\n    arrange(Date) %>%\n    mutate(Roll_Vol_20 = zoo::rollapply(Return_Pct, width = 20, FUN = sd, fill = NA, align = \"right\"))\n\np_czr_vol <- ggplot(czr, aes(x = Date, y = Roll_Vol_20)) +\n    geom_line(color = \"darkgreen\", linewidth = 0.8) +\n    labs(title = \"CZR: 20-Day Rolling Volatility\", y = \"Volatility (%)\") +\n    theme_minimal()\n\nprint(p_czr_vol)\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/czr-vol-acf-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\nacf(czr$Return_Pct^2, lag.max = 30, main = \"ACF: Squared Returns (CZR)\")\npacf(czr$Return_Pct^2, lag.max = 30, main = \"PACF: Squared Returns (CZR)\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/czr-vol-acf-2.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n\n\n**Observations**: CZR shows volatility clustering typical of casino/gaming stocks, with moderate ARCH effects visible in squared returns ACF.\n\n:::\n\n## MGM Resorts (MGM)\n\n::: {.panel-tabset}\n\n### Price & Returns\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_mgm1 <- ggplot(mgm, aes(x = Date, y = Adj_Close)) +\n    geom_line(color = \"#006bb6\", linewidth = 0.8) +\n    labs(\n        title = \"MGM Resorts (MGM) Stock Price\",\n        x = \"Date\", y = \"Price ($)\"\n    ) +\n    theme_minimal()\n\np_mgm2 <- ggplot(mgm, aes(x = Date, y = Return_Pct)) +\n    geom_line(color = \"darkred\", linewidth = 0.5, alpha = 0.7) +\n    geom_hline(yintercept = 0, linetype = \"dashed\", color = \"black\") +\n    labs(\n        title = \"MGM Resorts (MGM) Daily Returns\",\n        x = \"Date\", y = \"Return (%)\"\n    ) +\n    theme_minimal()\n\np_mgm1 / p_mgm2\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/mgm-price-returns-1.png){width=1152}\n:::\n:::\n\n\n\n### Volatility & ACF\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmgm <- mgm %>%\n    arrange(Date) %>%\n    mutate(Roll_Vol_20 = zoo::rollapply(Return_Pct, width = 20, FUN = sd, fill = NA, align = \"right\"))\n\np_mgm_vol <- ggplot(mgm, aes(x = Date, y = Roll_Vol_20)) +\n    geom_line(color = \"darkgreen\", linewidth = 0.8) +\n    labs(title = \"MGM: 20-Day Rolling Volatility\", y = \"Volatility (%)\") +\n    theme_minimal()\n\nprint(p_mgm_vol)\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/mgm-vol-acf-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\nacf(mgm$Return_Pct^2, lag.max = 30, main = \"ACF: Squared Returns (MGM)\")\npacf(mgm$Return_Pct^2, lag.max = 30, main = \"PACF: Squared Returns (MGM)\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/mgm-vol-acf-2.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n\n\n**Observations**: MGM exhibits similar volatility clustering patterns, characteristic of the gaming/hospitality sector with sports betting exposure.\n\n:::\n\n:::\n\n---\n\n# Model Fitting\n\n::: {.panel-tabset}\n\n## DraftKings (DKNG) Model\n\n::: {.panel-tabset}\n\n### Mean Equation Selection\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Prepare data\ndkng_returns <- dkng$Return_Pct\n\n# Fit candidate mean models (without GARCH first)\nmean_models <- list(\n    ARMA00 = arima(dkng_returns, order = c(0, 0, 0)),\n    ARMA10 = arima(dkng_returns, order = c(1, 0, 0)),\n    ARMA01 = arima(dkng_returns, order = c(0, 0, 1)),\n    ARMA11 = arima(dkng_returns, order = c(1, 0, 1))\n)\n\n# Compare AIC\nmean_aic <- data.frame(\n    Model = names(mean_models),\n    AIC = sapply(mean_models, AIC),\n    BIC = sapply(mean_models, BIC)\n)\n\ncat(\"=== Mean Equation Comparison ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== Mean Equation Comparison ===\n```\n\n\n:::\n\n```{.r .cell-code}\nkable(mean_aic,\n    format = \"html\",\n    digits = 2,\n    caption = \"Model Comparison: Mean Equation Only\"\n) %>%\n    kable_styling(\n        full_width = FALSE,\n        bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\")\n    ) %>%\n    row_spec(which.min(mean_aic$AIC), bold = TRUE, color = \"white\", background = \"#006bb6\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Model Comparison: Mean Equation Only</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA00 </td>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA00 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 6758.31 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 6768.46 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA10 </td>\n   <td style=\"text-align:left;\"> ARMA10 </td>\n   <td style=\"text-align:right;\"> 6758.35 </td>\n   <td style=\"text-align:right;\"> 6773.57 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA01 </td>\n   <td style=\"text-align:left;\"> ARMA01 </td>\n   <td style=\"text-align:right;\"> 6758.42 </td>\n   <td style=\"text-align:right;\"> 6773.64 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA11 </td>\n   <td style=\"text-align:left;\"> ARMA11 </td>\n   <td style=\"text-align:right;\"> 6760.10 </td>\n   <td style=\"text-align:right;\"> 6780.39 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Check for ARCH Effects\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use best mean model from AIC\nbest_mean_idx <- which.min(mean_aic$AIC)\nbest_mean_model <- mean_models[[best_mean_idx]]\nbest_mean_name <- names(mean_models)[best_mean_idx]\n\ncat(\"\\nSelected Mean Model:\", best_mean_name, \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nSelected Mean Model: ARMA00 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Extract residuals\nresid_mean <- residuals(best_mean_model)\n\n# Plot standardized residuals and squared residuals\npar(mfrow = c(2, 2))\nplot(resid_mean, type = \"l\", main = \"Standardized Residuals\", ylab = \"Residuals\")\nabline(h = 0, col = \"red\", lty = 2)\nplot(resid_mean^2, type = \"l\", main = \"Squared Residuals\", ylab = \"Residuals\")\nacf(resid_mean^2, lag.max = 30, main = \"ACF: Squared Residuals\")\npacf(resid_mean^2, lag.max = 30, main = \"PACF: Squared Residuals\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/dkng-arch-test-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n\n# ARCH LM test\narch_test <- FinTS::ArchTest(resid_mean, lags = 12)\ncat(\"\\n=== ARCH LM Test ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== ARCH LM Test ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Null Hypothesis: No ARCH effects\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNull Hypothesis: No ARCH effects\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Chi-squared:\", round(arch_test$statistic, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nChi-squared: 45.9102 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"p-value:\", format(arch_test$p.value, scientific = TRUE, digits = 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\np-value: 7.19e-06 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Conclusion:\", ifelse(arch_test$p.value < 0.05,\n    \"REJECT H0 - ARCH effects present, GARCH modeling needed\",\n    \"Fail to reject H0 - No ARCH effects\"\n), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConclusion: REJECT H0 - ARCH effects present, GARCH modeling needed \n```\n\n\n:::\n:::\n\n\n\n**Interpretation**:\n\n- **Squared Residuals**: Show clear autocorrelation even after fitting the mean equation\n- **ARCH LM Test**: Highly significant (p < 0.05), confirming ARCH effects\n- **Conclusion**: We need to add a GARCH variance equation to properly model volatility\n\n### Fit ARMA+GARCH Models\n\nNow we fit complete models with GARCH(1,1) variance equation:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Model specifications to test\nmodel_specs <- list(\n    list(formula = ~ garch(1, 1), name = \"ARMA(0,0)+GARCH(1,1)\"),\n    list(formula = ~ arma(1, 0) + garch(1, 1), name = \"ARMA(1,0)+GARCH(1,1)\"),\n    list(formula = ~ arma(0, 1) + garch(1, 1), name = \"ARMA(0,1)+GARCH(1,1)\"),\n    list(formula = ~ arma(1, 1) + garch(1, 1), name = \"ARMA(1,1)+GARCH(1,1)\")\n)\n\n# Fit all models\ngarch_models <- list()\ngarch_results <- data.frame()\n\nfor (spec in model_specs) {\n    # Fit model\n    fit <- tryCatch(\n        {\n            garchFit(formula = spec$formula, data = dkng_returns, trace = FALSE)\n        },\n        error = function(e) {\n            cat(\"Warning: Failed to fit\", spec$name, \"\\n\")\n            NULL\n        }\n    )\n\n    if (!is.null(fit)) {\n        garch_models[[spec$name]] <- fit\n\n        # Extract information criteria\n        aic_val <- fit@fit$ics[\"AIC\"]\n        bic_val <- fit@fit$ics[\"BIC\"]\n        loglik_val <- fit@fit$llh\n\n        garch_results <- rbind(garch_results, data.frame(\n            Model = spec$name,\n            AIC = aic_val,\n            BIC = bic_val,\n            Log_Likelihood = loglik_val\n        ))\n    }\n}\n\ncat(\"=== GARCH Model Comparison ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== GARCH Model Comparison ===\n```\n\n\n:::\n:::\n\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Model Comparison: ARMA+GARCH(1,1) Models for DKNG</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> Log_Likelihood </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(0,0)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 5.5951 </td>\n   <td style=\"text-align:right;\"> 5.6123 </td>\n   <td style=\"text-align:right;\"> 3297.091 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA(1,0)+GARCH(1,1) </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 5.5899 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 5.6114 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 3293.044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(0,1)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 5.5901 </td>\n   <td style=\"text-align:right;\"> 5.6116 </td>\n   <td style=\"text-align:right;\"> 3293.172 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(1,1)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 5.5914 </td>\n   <td style=\"text-align:right;\"> 5.6172 </td>\n   <td style=\"text-align:right;\"> 3292.924 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select best model\nbest_garch_idx <- which.min(garch_results$AIC)\nbest_garch_name <- garch_results$Model[best_garch_idx]\nbest_garch_model <- garch_models[[best_garch_name]]\n\ncat(\"\\n*** BEST MODEL:\", best_garch_name, \"***\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n*** BEST MODEL: ARMA(1,0)+GARCH(1,1) ***\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Model Coefficients:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel Coefficients:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(coef(best_garch_model))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        mu        ar1      omega     alpha1      beta1 \n0.06268864 0.06170713 0.06162636 0.02794633 0.96813987 \n```\n\n\n:::\n:::\n\n\n\n### Model Diagnostics\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract standardized residuals\nstd_resid <- residuals(best_garch_model, standardize = TRUE)\n\n# Diagnostic plots\npar(mfrow = c(3, 2))\n\n# 1. Standardized residuals\nplot(std_resid, type = \"l\", main = \"Standardized Residuals\", ylab = \"Std. Residuals\")\nabline(h = 0, col = \"red\", lty = 2)\nabline(h = c(-2, 2), col = \"blue\", lty = 2)\n\n# 2. Squared standardized residuals\nplot(std_resid^2, type = \"l\", main = \"Squared Standardized Residuals\", ylab = \"Std. Residuals\")\n\n# 3. ACF of standardized residuals\nacf(std_resid, lag.max = 20, main = \"ACF: Standardized Residuals\")\n\n# 4. ACF of squared standardized residuals\nacf(std_resid^2, lag.max = 20, main = \"ACF: Squared Std. Residuals\")\n\n# 5. QQ plot\nqqnorm(std_resid, main = \"Q-Q Plot: Standardized Residuals\")\nqqline(std_resid, col = \"red\")\n\n# 6. Histogram\nhist(std_resid, breaks = 50, probability = TRUE, main = \"Distribution of Std. Residuals\", xlab = \"Std. Residuals\")\ncurve(dnorm(x), add = TRUE, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/dkng-diagnostics-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ljung-Box test on standardized residuals\ncat(\"\\n=== Ljung-Box Test (Standardized Residuals) ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== Ljung-Box Test (Standardized Residuals) ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Null Hypothesis: Residuals are white noise (no autocorrelation)\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNull Hypothesis: Residuals are white noise (no autocorrelation)\n```\n\n\n:::\n\n```{.r .cell-code}\nlb_test_resid <- Box.test(std_resid, lag = 10, type = \"Ljung-Box\", fitdf = 0)\ncat(\"Lag 10:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLag 10:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Q-statistic:\", round(lb_test_resid$statistic, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Q-statistic: 6.2718 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  p-value:\", round(lb_test_resid$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  p-value: 0.7919 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Conclusion:\", ifelse(lb_test_resid$p.value > 0.05,\n    \"No autocorrelation detected (good)\",\n    \"Autocorrelation detected (concern)\"\n), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Conclusion: No autocorrelation detected (good) \n```\n\n\n:::\n\n```{.r .cell-code}\n# Ljung-Box test on squared standardized residuals\ncat(\"=== Ljung-Box Test (Squared Standardized Residuals) ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== Ljung-Box Test (Squared Standardized Residuals) ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Null Hypothesis: No remaining ARCH effects\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNull Hypothesis: No remaining ARCH effects\n```\n\n\n:::\n\n```{.r .cell-code}\nlb_test_sq <- Box.test(std_resid^2, lag = 10, type = \"Ljung-Box\", fitdf = 0)\ncat(\"Lag 10:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLag 10:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Q-statistic:\", round(lb_test_sq$statistic, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Q-statistic: 2.7834 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  p-value:\", round(lb_test_sq$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  p-value: 0.9861 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Conclusion:\", ifelse(lb_test_sq$p.value > 0.05,\n    \"ARCH effects successfully captured (good)\",\n    \"Remaining ARCH effects (may need higher order)\"\n), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Conclusion: ARCH effects successfully captured (good) \n```\n\n\n:::\n:::\n\n\n\n**Diagnostic Interpretation**:\n\n- **ACF of Std. Residuals**: No significant autocorrelation (validates mean equation)\n- **Ljung-Box Tests**: p-values > 0.05 indicate the model has adequately captured temporal dependencies\n- **Q-Q Plot**: Some deviation in tails suggests fat-tailed distribution (could consider t-distribution)\n\n### Volatility Forecast\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract conditional volatility\ncond_vol <- best_garch_model@sigma.t\n\n# Create data frame for plotting\nvol_df <- data.frame(\n    Date = dkng$Date,\n    Return_Pct = dkng$Return_Pct,\n    Cond_Vol = as.numeric(cond_vol)\n)\n\n# Plot returns with conditional volatility bands\nggplot(vol_df, aes(x = Date)) +\n    geom_line(aes(y = Return_Pct), color = \"black\", alpha = 0.6, linewidth = 0.4) +\n    geom_ribbon(aes(ymin = -2 * Cond_Vol, ymax = 2 * Cond_Vol),\n        fill = \"blue\", alpha = 0.2\n    ) +\n    geom_line(aes(y = 2 * Cond_Vol), color = \"blue\", linetype = \"dashed\", linewidth = 0.6) +\n    geom_line(aes(y = -2 * Cond_Vol), color = \"blue\", linetype = \"dashed\", linewidth = 0.6) +\n    geom_hline(yintercept = 0, linetype = \"solid\", color = \"red\", linewidth = 0.5) +\n    labs(\n        title = \"DKNG: Returns with GARCH Conditional Volatility (2 bands)\",\n        subtitle = \"Blue bands show time-varying volatility forecast\",\n        x = \"Date\",\n        y = \"Return (%)\"\n    ) +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/dkng-volatility-forecast-1.png){width=1152}\n:::\n\n```{.r .cell-code}\n# Plot conditional volatility over time\nggplot(vol_df, aes(x = Date, y = Cond_Vol)) +\n    geom_line(color = \"darkgreen\", linewidth = 0.8) +\n    labs(\n        title = \"DKNG: GARCH Conditional Volatility Over Time\",\n        subtitle = \"Volatility forecast from GARCH(1,1) model\",\n        x = \"Date\",\n        y = \"Conditional Volatility (%)\"\n    ) +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/dkng-volatility-forecast-2.png){width=1152}\n:::\n\n```{.r .cell-code}\ncat(\"\\nCurrent Volatility (last observation):\", round(tail(cond_vol, 1), 4), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCurrent Volatility (last observation): 2.8037 %\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Average Volatility:\", round(mean(cond_vol), 4), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAverage Volatility: 4.0695 %\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Max Volatility:\", round(max(cond_vol), 4), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMax Volatility: 7.4334 %\n```\n\n\n:::\n:::\n\n\n\n:::\n\n---\n\n## Penn Entertainment (PENN) Model\n\n::: {.panel-tabset}\n\n### Mean Equation & ARCH Test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenn_returns <- penn$Return_Pct\n\n# Fit candidate mean models\nmean_models_penn <- list(\n    ARMA00 = arima(penn_returns, order = c(0, 0, 0)),\n    ARMA10 = arima(penn_returns, order = c(1, 0, 0)),\n    ARMA01 = arima(penn_returns, order = c(0, 0, 1)),\n    ARMA11 = arima(penn_returns, order = c(1, 0, 1))\n)\n\nmean_aic_penn <- data.frame(\n    Model = names(mean_models_penn),\n    AIC = sapply(mean_models_penn, AIC),\n    BIC = sapply(mean_models_penn, BIC)\n)\n\ncat(\"=== PENN Mean Equation Comparison ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== PENN Mean Equation Comparison ===\n```\n\n\n:::\n\n```{.r .cell-code}\nkable(mean_aic_penn,\n    format = \"html\",\n    digits = 2,\n    caption = \"Model Comparison: Mean Equation Only (PENN)\"\n) %>%\n    kable_styling(\n        full_width = FALSE,\n        bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\")\n    ) %>%\n    row_spec(which.min(mean_aic_penn$AIC), bold = TRUE, color = \"white\", background = \"#006bb6\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Model Comparison: Mean Equation Only (PENN)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA00 </td>\n   <td style=\"text-align:left;\"> ARMA00 </td>\n   <td style=\"text-align:right;\"> 7588.17 </td>\n   <td style=\"text-align:right;\"> 7598.44 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA10 </td>\n   <td style=\"text-align:left;\"> ARMA10 </td>\n   <td style=\"text-align:right;\"> 7578.96 </td>\n   <td style=\"text-align:right;\"> 7594.37 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA01 </td>\n   <td style=\"text-align:left;\"> ARMA01 </td>\n   <td style=\"text-align:right;\"> 7581.16 </td>\n   <td style=\"text-align:right;\"> 7596.57 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA11 </td>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA11 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 7575.91 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 7596.46 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# ARCH test\nbest_mean_penn <- mean_models_penn[[which.min(mean_aic_penn$AIC)]]\nresid_penn <- residuals(best_mean_penn)\n\narch_test_penn <- FinTS::ArchTest(resid_penn, lags = 12)\ncat(\"\\n=== ARCH LM Test (PENN) ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== ARCH LM Test (PENN) ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"p-value:\", format(arch_test_penn$p.value, scientific = TRUE, digits = 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\np-value: 2.462e-99 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Conclusion:\", ifelse(arch_test_penn$p.value < 0.05,\n    \"ARCH effects present - GARCH needed\",\n    \"No ARCH effects\"\n), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConclusion: ARCH effects present - GARCH needed \n```\n\n\n:::\n:::\n\n\n\n### GARCH Model Fitting\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarch_models_penn <- list()\ngarch_results_penn <- data.frame()\n\nfor (spec in model_specs) {\n    # Fit model using fGarch\n    fit <- tryCatch(\n        {\n            garchFit(formula = spec$formula, data = penn_returns, trace = FALSE)\n        },\n        error = function(e) {\n            cat(\"Warning: Failed to fit\", spec$name, \"for PENN\\n\")\n            NULL\n        }\n    )\n\n    if (!is.null(fit)) {\n        garch_models_penn[[spec$name]] <- fit\n\n        # Extract information criteria\n        aic_val <- fit@fit$ics[\"AIC\"]\n        bic_val <- fit@fit$ics[\"BIC\"]\n        loglik_val <- fit@fit$llh\n\n        garch_results_penn <- rbind(garch_results_penn, data.frame(\n            Model = spec$name,\n            AIC = aic_val,\n            BIC = bic_val,\n            Log_Likelihood = loglik_val\n        ))\n    }\n}\n\ncat(\"=== PENN GARCH Model Comparison ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== PENN GARCH Model Comparison ===\n```\n\n\n:::\n:::\n\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Model Comparison: ARMA+GARCH(1,1) Models for PENN</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> Log_Likelihood </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA(0,0)+GARCH(1,1) </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 5.6132 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 5.6295 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 3523.881 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(1,0)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 5.6141 </td>\n   <td style=\"text-align:right;\"> 5.6345 </td>\n   <td style=\"text-align:right;\"> 3523.455 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(0,1)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 5.6141 </td>\n   <td style=\"text-align:right;\"> 5.6345 </td>\n   <td style=\"text-align:right;\"> 3523.469 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(1,1)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 5.6156 </td>\n   <td style=\"text-align:right;\"> 5.6402 </td>\n   <td style=\"text-align:right;\"> 3523.433 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_garch_penn <- garch_models_penn[[which.min(garch_results_penn$AIC)]]\nbest_name_penn <- garch_results_penn$Model[which.min(garch_results_penn$AIC)]\n\ncat(\"\\n*** BEST MODEL:\", best_name_penn, \"***\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n*** BEST MODEL: ARMA(0,0)+GARCH(1,1) ***\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Model Coefficients:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel Coefficients:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(coef(best_garch_penn))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         mu       omega      alpha1       beta1 \n-0.03411880  0.86283109  0.09135361  0.86147898 \n```\n\n\n:::\n:::\n\n\n\n### Diagnostics\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstd_resid_penn <- residuals(best_garch_penn, standardize = TRUE)\n\npar(mfrow = c(3, 2))\nplot(std_resid_penn, type = \"l\", main = \"Standardized Residuals (PENN)\")\nabline(h = 0, col = \"red\", lty = 2)\nplot(std_resid_penn^2, type = \"l\", main = \"Squared Std. Residuals (PENN)\")\nacf(std_resid_penn, lag.max = 20, main = \"ACF: Std. Residuals\")\nacf(std_resid_penn^2, lag.max = 20, main = \"ACF: Squared Std. Residuals\")\nqqnorm(std_resid_penn, main = \"Q-Q Plot\")\nqqline(std_resid_penn, col = \"red\")\nhist(std_resid_penn, breaks = 50, probability = TRUE, main = \"Distribution\")\ncurve(dnorm(x), add = TRUE, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/penn-diagnostics-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n\n# Ljung-Box tests\nlb_penn <- Box.test(std_resid_penn, lag = 10, type = \"Ljung-Box\")\nlb_penn_sq <- Box.test(std_resid_penn^2, lag = 10, type = \"Ljung-Box\")\n\ncat(\"\\nLjung-Box (Std. Residuals): p =\", round(lb_penn$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nLjung-Box (Std. Residuals): p = 0.438 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Ljung-Box (Squared): p =\", round(lb_penn_sq$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLjung-Box (Squared): p = 0.8794 \n```\n\n\n:::\n:::\n\n\n\n### Volatility Forecast\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncond_vol_penn <- best_garch_penn@sigma.t\n\nvol_df_penn <- data.frame(\n    Date = penn$Date,\n    Return_Pct = penn$Return_Pct,\n    Cond_Vol = as.numeric(cond_vol_penn)\n)\n\nggplot(vol_df_penn, aes(x = Date)) +\n    geom_line(aes(y = Return_Pct), color = \"black\", alpha = 0.6, linewidth = 0.4) +\n    geom_ribbon(aes(ymin = -2 * Cond_Vol, ymax = 2 * Cond_Vol),\n        fill = \"red\", alpha = 0.2\n    ) +\n    geom_line(aes(y = 2 * Cond_Vol), color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n    geom_line(aes(y = -2 * Cond_Vol), color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n    geom_hline(yintercept = 0, linetype = \"solid\", color = \"black\", linewidth = 0.5) +\n    labs(\n        title = \"PENN: Returns with GARCH Conditional Volatility\",\n        x = \"Date\", y = \"Return (%)\"\n    ) +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/penn-volatility-1.png){width=1152}\n:::\n\n```{.r .cell-code}\nggplot(vol_df_penn, aes(x = Date, y = Cond_Vol)) +\n    geom_line(color = \"darkred\", linewidth = 0.8) +\n    labs(\n        title = \"PENN: GARCH Conditional Volatility\",\n        x = \"Date\", y = \"Conditional Volatility (%)\"\n    ) +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/penn-volatility-2.png){width=1152}\n:::\n:::\n\n\n\n:::\n\n## Caesars Entertainment (CZR) Model\n\n::: {.panel-tabset}\n\n### Mean Equation & ARCH Test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nczr_returns <- czr$Return_Pct\n\n# Fit candidate mean models\nmean_models_czr <- list(\n    ARMA00 = arima(czr_returns, order = c(0, 0, 0)),\n    ARMA10 = arima(czr_returns, order = c(1, 0, 0)),\n    ARMA01 = arima(czr_returns, order = c(0, 0, 1)),\n    ARMA11 = arima(czr_returns, order = c(1, 0, 1))\n)\n\nmean_aic_czr <- data.frame(\n    Model = names(mean_models_czr),\n    AIC = sapply(mean_models_czr, AIC),\n    BIC = sapply(mean_models_czr, BIC)\n)\n\ncat(\"=== CZR Mean Equation Comparison ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== CZR Mean Equation Comparison ===\n```\n\n\n:::\n\n```{.r .cell-code}\nkable(mean_aic_czr,\n    format = \"html\",\n    digits = 2,\n    caption = \"Model Comparison: Mean Equation Only (CZR)\"\n) %>%\n    kable_styling(\n        full_width = FALSE,\n        bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\")\n    ) %>%\n    row_spec(which.min(mean_aic_czr$AIC), bold = TRUE, color = \"white\", background = \"#006bb6\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Model Comparison: Mean Equation Only (CZR)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA00 </td>\n   <td style=\"text-align:left;\"> ARMA00 </td>\n   <td style=\"text-align:right;\"> 8671.32 </td>\n   <td style=\"text-align:right;\"> 8681.92 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA10 </td>\n   <td style=\"text-align:left;\"> ARMA10 </td>\n   <td style=\"text-align:right;\"> 8656.90 </td>\n   <td style=\"text-align:right;\"> 8672.79 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA01 </td>\n   <td style=\"text-align:left;\"> ARMA01 </td>\n   <td style=\"text-align:right;\"> 8658.86 </td>\n   <td style=\"text-align:right;\"> 8674.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA11 </td>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA11 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 8655.48 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 8676.67 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# ARCH test\nbest_mean_czr <- mean_models_czr[[which.min(mean_aic_czr$AIC)]]\nresid_czr <- residuals(best_mean_czr)\n\ncat(\"\\n\")\n```\n\n```{.r .cell-code}\n# Plot squared residuals\npar(mfrow = c(1, 2))\nacf(resid_czr^2, lag.max = 30, main = \"ACF: Squared Residuals (CZR)\")\npacf(resid_czr^2, lag.max = 30, main = \"PACF: Squared Residuals (CZR)\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/czr-mean-models-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n\narch_test_czr <- FinTS::ArchTest(resid_czr, lags = 12)\ncat(\"\\n=== ARCH LM Test (CZR) ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== ARCH LM Test (CZR) ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Chi-squared:\", round(arch_test_czr$statistic, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nChi-squared: 532.7903 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"p-value:\", format(arch_test_czr$p.value, scientific = TRUE, digits = 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\np-value: 2.305e-106 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Conclusion:\", ifelse(arch_test_czr$p.value < 0.05,\n    \"ARCH effects present → GARCH needed\",\n    \"No ARCH effects\"\n), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConclusion: ARCH effects present → GARCH needed \n```\n\n\n:::\n:::\n\n\n\n**Interpretation**: The ACF/PACF of squared residuals show significant autocorrelation at multiple lags, and the ARCH LM test confirms the presence of ARCH effects. This validates the need for GARCH modeling to capture CZR's time-varying volatility.\n\n### GARCH Model Fitting\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarch_models_czr <- list()\ngarch_results_czr <- data.frame()\n\nfor (spec in model_specs) {\n    # Fit model using fGarch\n    fit <- tryCatch(\n        {\n            garchFit(formula = spec$formula, data = czr_returns, trace = FALSE)\n        },\n        error = function(e) {\n            cat(\"Warning: Failed to fit\", spec$name, \"for CZR\\n\")\n            NULL\n        }\n    )\n\n    if (!is.null(fit)) {\n        garch_models_czr[[spec$name]] <- fit\n\n        # Extract information criteria\n        aic_val <- fit@fit$ics[\"AIC\"]\n        bic_val <- fit@fit$ics[\"BIC\"]\n        loglik_val <- fit@fit$llh\n\n        garch_results_czr <- rbind(garch_results_czr, data.frame(\n            Model = spec$name,\n            AIC = aic_val,\n            BIC = bic_val,\n            Log_Likelihood = loglik_val\n        ))\n    }\n}\n\ncat(\"=== CZR GARCH Model Comparison ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== CZR GARCH Model Comparison ===\n```\n\n\n:::\n:::\n\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Model Comparison: ARMA+GARCH(1,1) Models for CZR</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> Log_Likelihood </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA(0,0)+GARCH(1,1) </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 5.3783 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 5.3926 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 3967.845 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(1,0)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 5.3784 </td>\n   <td style=\"text-align:right;\"> 5.3963 </td>\n   <td style=\"text-align:right;\"> 3966.944 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(0,1)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 5.3784 </td>\n   <td style=\"text-align:right;\"> 5.3963 </td>\n   <td style=\"text-align:right;\"> 3966.913 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(1,1)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 5.3796 </td>\n   <td style=\"text-align:right;\"> 5.4011 </td>\n   <td style=\"text-align:right;\"> 3966.849 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_garch_czr <- garch_models_czr[[which.min(garch_results_czr$AIC)]]\nbest_name_czr <- garch_results_czr$Model[which.min(garch_results_czr$AIC)]\n\ncat(\"\\n*** BEST MODEL:\", best_name_czr, \"***\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n*** BEST MODEL: ARMA(0,0)+GARCH(1,1) ***\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Model Coefficients:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel Coefficients:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(coef(best_garch_czr))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         mu       omega      alpha1       beta1 \n-0.01029034  0.66993148  0.11243921  0.84204206 \n```\n\n\n:::\n:::\n\n\n\n**Model Selection Rationale**: The AIC-selected model balances fit and parsimony. CZR exhibits volatility patterns driven by both established gaming operations and newer sports betting ventures.\n\n### Diagnostics\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstd_resid_czr <- residuals(best_garch_czr, standardize = TRUE)\n\npar(mfrow = c(3, 2))\nplot(std_resid_czr, type = \"l\", main = \"Standardized Residuals (CZR)\", ylab = \"Std. Residuals\")\nabline(h = 0, col = \"red\", lty = 2)\nabline(h = c(-2, 2), col = \"blue\", lty = 2)\n\nplot(std_resid_czr^2, type = \"l\", main = \"Squared Std. Residuals (CZR)\", ylab = \"Residuals²\")\n\nacf(std_resid_czr, lag.max = 20, main = \"ACF: Std. Residuals\")\nacf(std_resid_czr^2, lag.max = 20, main = \"ACF: Squared Std. Residuals\")\n\nqqnorm(std_resid_czr, main = \"Q-Q Plot (CZR)\")\nqqline(std_resid_czr, col = \"red\")\n\nhist(std_resid_czr, breaks = 50, probability = TRUE, main = \"Distribution (CZR)\", xlab = \"Std. Residuals\")\ncurve(dnorm(x), add = TRUE, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/czr-diagnostics-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n\n# Ljung-Box tests\nlb_czr <- Box.test(std_resid_czr, lag = 10, type = \"Ljung-Box\")\nlb_czr_sq <- Box.test(std_resid_czr^2, lag = 10, type = \"Ljung-Box\")\n\ncat(\"\\n=== Ljung-Box Tests (CZR) ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== Ljung-Box Tests (CZR) ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Standardized Residuals: p =\", round(lb_czr$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStandardized Residuals: p = 0.5736 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Conclusion:\", ifelse(lb_czr$p.value > 0.05,\n    \"No autocorrelation (good)\",\n    \"Autocorrelation present (concern)\"\n), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Conclusion: No autocorrelation (good) \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Squared Std. Residuals: p =\", round(lb_czr_sq$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSquared Std. Residuals: p = 0.7876 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Conclusion:\", ifelse(lb_czr_sq$p.value > 0.05,\n    \"ARCH effects captured (good)\",\n    \"Remaining ARCH effects\"\n), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Conclusion: ARCH effects captured (good) \n```\n\n\n:::\n:::\n\n\n\n**Diagnostic Summary**:\n- Standardized residuals should resemble white noise (no pattern in ACF)\n- Squared residuals ACF tests whether GARCH captured all volatility clustering\n- Ljung-Box p > 0.05 indicates successful model specification\n- Q-Q plot reveals any remaining fat-tail characteristics\n\n### Volatility Forecast\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncond_vol_czr <- best_garch_czr@sigma.t\n\nvol_df_czr <- data.frame(\n    Date = czr$Date,\n    Return_Pct = czr$Return_Pct,\n    Cond_Vol = as.numeric(cond_vol_czr)\n)\n\nggplot(vol_df_czr, aes(x = Date)) +\n    geom_line(aes(y = Return_Pct), color = \"black\", alpha = 0.6, linewidth = 0.4) +\n    geom_ribbon(aes(ymin = -2 * Cond_Vol, ymax = 2 * Cond_Vol),\n        fill = \"darkgreen\", alpha = 0.2\n    ) +\n    geom_line(aes(y = 2 * Cond_Vol), color = \"darkgreen\", linetype = \"dashed\", linewidth = 0.6) +\n    geom_line(aes(y = -2 * Cond_Vol), color = \"darkgreen\", linetype = \"dashed\", linewidth = 0.6) +\n    geom_hline(yintercept = 0, linetype = \"solid\", color = \"black\", linewidth = 0.5) +\n    labs(\n        title = \"CZR: Returns with GARCH Conditional Volatility (±2σ bands)\",\n        subtitle = \"Green bands show time-varying volatility forecast\",\n        x = \"Date\",\n        y = \"Return (%)\"\n    ) +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/czr-volatility-1.png){width=1152}\n:::\n\n```{.r .cell-code}\nggplot(vol_df_czr, aes(x = Date, y = Cond_Vol)) +\n    geom_line(color = \"darkgreen\", linewidth = 0.8) +\n    labs(\n        title = \"CZR: GARCH Conditional Volatility Over Time\",\n        subtitle = \"Volatility reflects both casino operations and sports betting integration\",\n        x = \"Date\",\n        y = \"Conditional Volatility (%)\"\n    ) +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/czr-volatility-2.png){width=1152}\n:::\n\n```{.r .cell-code}\ncat(\"\\nCurrent Volatility (last observation):\", round(tail(cond_vol_czr, 1), 4), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCurrent Volatility (last observation): 3.3838 %\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Average Volatility:\", round(mean(cond_vol_czr), 4), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAverage Volatility: 3.8232 %\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Max Volatility:\", round(max(cond_vol_czr), 4), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMax Volatility: 22.069 %\n```\n\n\n:::\n:::\n\n\n\n**Volatility Interpretation**: CZR's conditional volatility shows periods of elevated risk during major corporate events. The GARCH model successfully tracks these time-varying patterns, providing valuable risk forecasts for portfolio managers and options traders.\n\n:::\n\n## MGM Resorts (MGM) Model\n\n::: {.panel-tabset}\n\n### Mean Equation & ARCH Test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmgm_returns <- mgm$Return_Pct\n\n# Fit candidate mean models\nmean_models_mgm <- list(\n    ARMA00 = arima(mgm_returns, order = c(0, 0, 0)),\n    ARMA10 = arima(mgm_returns, order = c(1, 0, 0)),\n    ARMA01 = arima(mgm_returns, order = c(0, 0, 1)),\n    ARMA11 = arima(mgm_returns, order = c(1, 0, 1))\n)\n\nmean_aic_mgm <- data.frame(\n    Model = names(mean_models_mgm),\n    AIC = sapply(mean_models_mgm, AIC),\n    BIC = sapply(mean_models_mgm, BIC)\n)\n\ncat(\"=== MGM Mean Equation Comparison ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== MGM Mean Equation Comparison ===\n```\n\n\n:::\n\n```{.r .cell-code}\nkable(mean_aic_mgm,\n    format = \"html\",\n    digits = 2,\n    caption = \"Model Comparison: Mean Equation Only (MGM)\"\n) %>%\n    kable_styling(\n        full_width = FALSE,\n        bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\")\n    ) %>%\n    row_spec(which.min(mean_aic_mgm$AIC), bold = TRUE, color = \"white\", background = \"#006bb6\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Model Comparison: Mean Equation Only (MGM)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA00 </td>\n   <td style=\"text-align:left;\"> ARMA00 </td>\n   <td style=\"text-align:right;\"> 7815.75 </td>\n   <td style=\"text-align:right;\"> 7826.35 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA10 </td>\n   <td style=\"text-align:left;\"> ARMA10 </td>\n   <td style=\"text-align:right;\"> 7815.98 </td>\n   <td style=\"text-align:right;\"> 7831.87 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA01 </td>\n   <td style=\"text-align:left;\"> ARMA01 </td>\n   <td style=\"text-align:right;\"> 7816.29 </td>\n   <td style=\"text-align:right;\"> 7832.19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA11 </td>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA11 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 7814.28 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 7835.47 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# ARCH test\nbest_mean_mgm <- mean_models_mgm[[which.min(mean_aic_mgm$AIC)]]\nresid_mgm <- residuals(best_mean_mgm)\n\ncat(\"\\n\")\n```\n\n```{.r .cell-code}\n# Plot squared residuals\npar(mfrow = c(1, 2))\nacf(resid_mgm^2, lag.max = 30, main = \"ACF: Squared Residuals (MGM)\")\npacf(resid_mgm^2, lag.max = 30, main = \"PACF: Squared Residuals (MGM)\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/mgm-mean-models-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n\narch_test_mgm <- FinTS::ArchTest(resid_mgm, lags = 12)\ncat(\"\\n=== ARCH LM Test (MGM) ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== ARCH LM Test (MGM) ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Chi-squared:\", round(arch_test_mgm$statistic, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nChi-squared: 467.1476 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"p-value:\", format(arch_test_mgm$p.value, scientific = TRUE, digits = 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\np-value: 2.15e-92 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Conclusion:\", ifelse(arch_test_mgm$p.value < 0.05,\n    \"ARCH effects present → GARCH needed\",\n    \"No ARCH effects\"\n), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConclusion: ARCH effects present → GARCH needed \n```\n\n\n:::\n:::\n\n\n\n**Interpretation**: Despite MGM's diversified business model, the stock still exhibits ARCH effects, though potentially milder than pure-play sports betting stocks. The ARCH LM test confirms time-varying volatility requiring GARCH specification.\n\n### GARCH Model Fitting\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarch_models_mgm <- list()\ngarch_results_mgm <- data.frame()\n\nfor (spec in model_specs) {\n    # Fit model using fGarch\n    fit <- tryCatch(\n        {\n            garchFit(formula = spec$formula, data = mgm_returns, trace = FALSE)\n        },\n        error = function(e) {\n            cat(\"Warning: Failed to fit\", spec$name, \"for MGM\\n\")\n            NULL\n        }\n    )\n\n    if (!is.null(fit)) {\n        garch_models_mgm[[spec$name]] <- fit\n\n        # Extract information criteria\n        aic_val <- fit@fit$ics[\"AIC\"]\n        bic_val <- fit@fit$ics[\"BIC\"]\n        loglik_val <- fit@fit$llh\n\n        garch_results_mgm <- rbind(garch_results_mgm, data.frame(\n            Model = spec$name,\n            AIC = aic_val,\n            BIC = bic_val,\n            Log_Likelihood = loglik_val\n        ))\n    }\n}\n\ncat(\"=== MGM GARCH Model Comparison ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n=== MGM GARCH Model Comparison ===\n```\n\n\n:::\n:::\n\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Model Comparison: ARMA+GARCH(1,1) Models for MGM</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> Log_Likelihood </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(0,0)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 4.9152 </td>\n   <td style=\"text-align:right;\"> 4.9296 </td>\n   <td style=\"text-align:right;\"> 3625.892 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(1,0)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 4.9165 </td>\n   <td style=\"text-align:right;\"> 4.9344 </td>\n   <td style=\"text-align:right;\"> 3625.799 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ARMA(0,1)+GARCH(1,1) </td>\n   <td style=\"text-align:right;\"> 4.9165 </td>\n   <td style=\"text-align:right;\"> 4.9344 </td>\n   <td style=\"text-align:right;\"> 3625.800 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> ARMA(1,1)+GARCH(1,1) </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 4.9142 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 4.9357 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 107, 182, 255) !important;\"> 3623.114 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_garch_mgm <- garch_models_mgm[[which.min(garch_results_mgm$AIC)]]\nbest_name_mgm <- garch_results_mgm$Model[which.min(garch_results_mgm$AIC)]\n\ncat(\"\\n*** BEST MODEL:\", best_name_mgm, \"***\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n*** BEST MODEL: ARMA(1,1)+GARCH(1,1) ***\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Model Coefficients:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nModel Coefficients:\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(coef(best_garch_mgm))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          mu          ar1          ma1        omega       alpha1        beta1 \n 0.002507931  0.951473676 -0.969389579  0.533056417  0.083842660  0.854398683 \n```\n\n\n:::\n:::\n\n\n\n**Model Selection Rationale**: The selected GARCH(1,1) specification for MGM captures volatility persistence while maintaining parsimony. MGM's diversified operations (Las Vegas Strip properties, regional casinos, BetMGM, entertainment venues) create a more stable volatility profile compared to pure-play operators, which should be reflected in the model coefficients.\n\n### Diagnostics\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstd_resid_mgm <- residuals(best_garch_mgm, standardize = TRUE)\n\npar(mfrow = c(3, 2))\nplot(std_resid_mgm, type = \"l\", main = \"Standardized Residuals (MGM)\", ylab = \"Std. Residuals\")\nabline(h = 0, col = \"red\", lty = 2)\nabline(h = c(-2, 2), col = \"blue\", lty = 2)\n\nplot(std_resid_mgm^2, type = \"l\", main = \"Squared Std. Residuals (MGM)\", ylab = \"Residuals²\")\n\nacf(std_resid_mgm, lag.max = 20, main = \"ACF: Std. Residuals\")\nacf(std_resid_mgm^2, lag.max = 20, main = \"ACF: Squared Std. Residuals\")\n\nqqnorm(std_resid_mgm, main = \"Q-Q Plot (MGM)\")\nqqline(std_resid_mgm, col = \"red\")\n\nhist(std_resid_mgm, breaks = 50, probability = TRUE, main = \"Distribution (MGM)\", xlab = \"Std. Residuals\")\ncurve(dnorm(x), add = TRUE, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/mgm-diagnostics-1.png){width=1152}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n\n# Ljung-Box tests\nlb_mgm <- Box.test(std_resid_mgm, lag = 10, type = \"Ljung-Box\")\nlb_mgm_sq <- Box.test(std_resid_mgm^2, lag = 10, type = \"Ljung-Box\")\n\ncat(\"\\n=== Ljung-Box Tests (MGM) ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== Ljung-Box Tests (MGM) ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Standardized Residuals: p =\", round(lb_mgm$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStandardized Residuals: p = 0.2804 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Conclusion:\", ifelse(lb_mgm$p.value > 0.05,\n    \"No autocorrelation (good)\",\n    \"Autocorrelation present (concern)\"\n), \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Conclusion: No autocorrelation (good) \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Squared Std. Residuals: p =\", round(lb_mgm_sq$p.value, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSquared Std. Residuals: p = 0.922 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"  Conclusion:\", ifelse(lb_mgm_sq$p.value > 0.05,\n    \"ARCH effects captured (good)\",\n    \"Remaining ARCH effects\"\n), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Conclusion: ARCH effects captured (good) \n```\n\n\n:::\n:::\n\n\n\n**Diagnostic Summary**: MGM's standardized residuals should show cleaner behavior than PENN or DKNG, reflecting the stabilizing effect of diversified revenue streams. Successful diagnostics (Ljung-Box p > 0.05) indicate the GARCH model adequately captures MGM's conditional volatility dynamics.\n\n### Volatility Forecast\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncond_vol_mgm <- best_garch_mgm@sigma.t\n\nvol_df_mgm <- data.frame(\n    Date = mgm$Date,\n    Return_Pct = mgm$Return_Pct,\n    Cond_Vol = as.numeric(cond_vol_mgm)\n)\n\nggplot(vol_df_mgm, aes(x = Date)) +\n    geom_line(aes(y = Return_Pct), color = \"black\", alpha = 0.6, linewidth = 0.4) +\n    geom_ribbon(aes(ymin = -2 * Cond_Vol, ymax = 2 * Cond_Vol),\n        fill = \"darkorange\", alpha = 0.2\n    ) +\n    geom_line(aes(y = 2 * Cond_Vol), color = \"darkorange\", linetype = \"dashed\", linewidth = 0.6) +\n    geom_line(aes(y = -2 * Cond_Vol), color = \"darkorange\", linetype = \"dashed\", linewidth = 0.6) +\n    geom_hline(yintercept = 0, linetype = \"solid\", color = \"black\", linewidth = 0.5) +\n    labs(\n        title = \"MGM: Returns with GARCH Conditional Volatility (±2σ bands)\",\n        subtitle = \"Orange bands show time-varying volatility forecast\",\n        x = \"Date\",\n        y = \"Return (%)\"\n    ) +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/mgm-volatility-1.png){width=1152}\n:::\n\n```{.r .cell-code}\nggplot(vol_df_mgm, aes(x = Date, y = Cond_Vol)) +\n    geom_line(color = \"darkorange\", linewidth = 0.8) +\n    labs(\n        title = \"MGM: GARCH Conditional Volatility Over Time\",\n        subtitle = \"Most stable volatility profile among all sports betting stocks\",\n        x = \"Date\",\n        y = \"Conditional Volatility (%)\"\n    ) +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/mgm-volatility-2.png){width=1152}\n:::\n\n```{.r .cell-code}\ncat(\"\\nCurrent Volatility (last observation):\", round(tail(cond_vol_mgm, 1), 4), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCurrent Volatility (last observation): 2.222 %\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Average Volatility:\", round(mean(cond_vol_mgm), 4), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAverage Volatility: 2.9554 %\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Max Volatility:\", round(max(cond_vol_mgm), 4), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMax Volatility: 15.3038 %\n```\n\n\n:::\n:::\n\n\n\n**Volatility Interpretation**: MGM's conditional volatility time series shows the lowest average volatility among all four stocks, confirming that diversification provides natural hedging against sector-specific shocks. The GARCH forecasts are particularly valuable for MGM during major events that create temporary volatility spikes.\n\n:::\n\n:::\n\n---\n\n# Model Equations\n\n::: {.panel-tabset}\n\n## DraftKings (DKNG)\n\n\n\n::: {.cell}\n\n:::\n\n\n\n**Selected Model**: ARMA(1,0)+GARCH(1,1)\n\n### Mean Equation\n\n$$\nr_t = 0.062689 + \\epsilon_t\n$$\n\nwhere $\\epsilon_t = \\sigma_t z_t$ and $z_t \\sim N(0, 1)$\n\n### Variance Equation (GARCH(1,1))\n\n$$\n\\sigma_t^2 = 0.061626 + 0.027946 \\epsilon_{t-1}^2 + 0.96814 \\sigma_{t-1}^2\n$$\n\n**Unconditional Variance**:\n\n$$\n\\sigma^2_{\\text{unconditional}} = \\frac{\\omega}{1 - \\alpha_1 - \\beta_1} = \\frac{0.061626}{1 - 0.9961} = 15.7459\n$$\n\nUnconditional volatility: 3.9681%\n\n## Penn Entertainment (PENN)\n\n\n\n::: {.cell}\n\n:::\n\n\n\n**Selected Model**: ARMA(0,0)+GARCH(1,1)\n\n### Mean Equation\n\n$$\nr_t = -0.034119 + \\epsilon_t\n$$\n\n### Variance Equation (GARCH(1,1))\n\n$$\n\\sigma_t^2 = 0.862831 + 0.091354 \\epsilon_{t-1}^2 + 0.861479 \\sigma_{t-1}^2\n$$\n\n## Caesars Entertainment (CZR)\n\n\n\n::: {.cell}\n\n:::\n\n\n\n**Selected Model**: ARMA(0,0)+GARCH(1,1)\n\n### Mean Equation\n\n$$\nr_t = -0.01029 + \\epsilon_t\n$$\n\nwhere $\\epsilon_t = \\sigma_t z_t$ and $z_t \\sim N(0, 1)$\n\n### Variance Equation (GARCH(1,1))\n\n$$\n\\sigma_t^2 = 0.669931 + 0.112439 \\epsilon_{t-1}^2 + 0.842042 \\sigma_{t-1}^2\n$$\n\n**Unconditional Variance**:\n\n$$\n\\sigma^2_{\\text{unconditional}} = \\frac{\\omega}{1 - \\alpha_1 - \\beta_1} = \\frac{0.669931}{1 - 0.9545} = 14.7177\n$$\n\nUnconditional volatility: 3.8364%\n\n## MGM Resorts (MGM)\n\n\n\n::: {.cell}\n\n:::\n\n\n\n**Selected Model**: ARMA(1,1)+GARCH(1,1)\n\n### Mean Equation\n\n$$\nr_t = 0.002508 + \\epsilon_t\n$$\n\nwhere $\\epsilon_t = \\sigma_t z_t$ and $z_t \\sim N(0, 1)$\n\n### Variance Equation (GARCH(1,1))\n\n$$\n\\sigma_t^2 = 0.533056 + 0.083843 \\epsilon_{t-1}^2 + 0.854399 \\sigma_{t-1}^2\n$$\n\n**Unconditional Variance**:\n\n$$\n\\sigma^2_{\\text{unconditional}} = \\frac{\\omega}{1 - \\alpha_1 - \\beta_1} = \\frac{0.533056}{1 - 0.9382} = 8.6313\n$$\n\nUnconditional volatility: 2.9379% (lowest among all four stocks)\n\n**Business Model Impact**: MGM's lower volatility parameters directly reflect its diversified operations. The smaller $\\alpha_1$ suggests that MGM's stock is less sensitive to short-term shocks, while moderate $\\beta_1$ indicates reasonable volatility persistence.\n\n:::\n\n---\n\n# Cross-Stock Comparison\n\nNow that we've analyzed individual stocks, let's compare volatility dynamics across all four sports betting companies.\n\n::: {.panel-tabset}\n\n## Volatility Comparison\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Combine all returns data\nall_returns <- bind_rows(\n    dkng %>% dplyr::select(Date, Return_Pct, Ticker),\n    penn %>% dplyr::select(Date, Return_Pct, Ticker),\n    czr %>% dplyr::select(Date, Return_Pct, Ticker),\n    mgm %>% dplyr::select(Date, Return_Pct, Ticker)\n)\n\n# Plot all returns together\np_all_returns <- ggplot(all_returns, aes(x = Date, y = Return_Pct, color = Ticker)) +\n    geom_line(alpha = 0.5, linewidth = 0.3) +\n    facet_wrap(~Ticker, ncol = 1) +\n    geom_hline(yintercept = 0, linetype = \"dashed\", color = \"black\") +\n    labs(\n        title = \"Daily Returns Comparison: All Sports Betting Stocks\",\n        subtitle = \"Volatility clustering visible across all stocks\",\n        x = \"Date\",\n        y = \"Return (%)\"\n    ) +\n    scale_color_manual(values = c(\n        \"DKNG\" = \"#006bb6\", \"PENN\" = \"darkred\",\n        \"CZR\" = \"darkgreen\", \"MGM\" = \"darkorange\"\n    )) +\n    theme_minimal() +\n    theme(legend.position = \"none\")\n\nprint(p_all_returns)\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/volatility-comparison-1.png){width=1344}\n:::\n\n```{.r .cell-code}\n# Rolling volatility comparison\nall_vol <- bind_rows(\n    dkng %>% dplyr::select(Date, Roll_Vol_20, Ticker),\n    penn %>% dplyr::select(Date, Roll_Vol_20, Ticker),\n    czr %>% dplyr::select(Date, Roll_Vol_20, Ticker),\n    mgm %>% dplyr::select(Date, Roll_Vol_20, Ticker)\n) %>% filter(!is.na(Roll_Vol_20))\n\np_vol_comp <- ggplot(all_vol, aes(x = Date, y = Roll_Vol_20, color = Ticker)) +\n    geom_line(linewidth = 0.8, alpha = 0.8) +\n    labs(\n        title = \"20-Day Rolling Volatility Comparison\",\n        subtitle = \"PENN shows highest volatility, MGM most stable\",\n        x = \"Date\",\n        y = \"Volatility (% std dev)\",\n        color = \"Stock\"\n    ) +\n    scale_color_manual(values = c(\n        \"DKNG\" = \"#006bb6\", \"PENN\" = \"darkred\",\n        \"CZR\" = \"darkgreen\", \"MGM\" = \"darkorange\"\n    )) +\n    theme_minimal() +\n    theme(legend.position = \"right\")\n\nprint(p_vol_comp)\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/volatility-comparison-2.png){width=1344}\n:::\n:::\n\n\n\n**Key Observations**:\n\n- **PENN** exhibits the highest volatility throughout the period, reflecting business model uncertainty\n- **MGM** shows the most stable returns, benefiting from diversified resort operations\n- **DKNG** and **CZR** display moderate volatility, typical of focused sports betting operators\n- All stocks show synchronized volatility spikes during market-wide events (COVID, regulatory news)\n\n## Statistical Summary\n\n\n\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Comparative Summary Statistics: Sports Betting Stocks</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Stock </th>\n   <th style=\"text-align:right;\"> Mean Return (%) </th>\n   <th style=\"text-align:right;\"> Volatility (%) </th>\n   <th style=\"text-align:right;\"> Min Return (%) </th>\n   <th style=\"text-align:right;\"> Max Return (%) </th>\n   <th style=\"text-align:right;\"> Skewness </th>\n   <th style=\"text-align:right;\"> Kurtosis </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> DKNG </td>\n   <td style=\"text-align:right;\"> 0.0638 </td>\n   <td style=\"text-align:right;\"> 4.2354 </td>\n   <td style=\"text-align:right;\"> -32.6061 </td>\n   <td style=\"text-align:right;\"> 15.9306 </td>\n   <td style=\"text-align:right;\"> -0.3807 </td>\n   <td style=\"text-align:right;\"> 7.8417 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(139, 0, 0, 255) !important;\"> PENN </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(139, 0, 0, 255) !important;\"> -0.0220 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(139, 0, 0, 255) !important;\"> 4.9443 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(139, 0, 0, 255) !important;\"> -59.4142 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(139, 0, 0, 255) !important;\"> 29.8592 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(139, 0, 0, 255) !important;\"> -1.7046 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(139, 0, 0, 255) !important;\"> 30.3981 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CZR </td>\n   <td style=\"text-align:right;\"> -0.0718 </td>\n   <td style=\"text-align:right;\"> 4.5517 </td>\n   <td style=\"text-align:right;\"> -47.0084 </td>\n   <td style=\"text-align:right;\"> 36.5733 </td>\n   <td style=\"text-align:right;\"> -0.9193 </td>\n   <td style=\"text-align:right;\"> 21.3669 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;color: white !important;background-color: rgba(0, 100, 0, 255) !important;\"> MGM </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 100, 0, 255) !important;\"> -0.0042 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 100, 0, 255) !important;\"> 3.4071 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 100, 0, 255) !important;\"> -40.9684 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 100, 0, 255) !important;\"> 28.6042 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 100, 0, 255) !important;\"> -0.9679 </td>\n   <td style=\"text-align:right;font-weight: bold;color: white !important;background-color: rgba(0, 100, 0, 255) !important;\"> 26.9113 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n\n\n\n## Return Distributions\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Density plots\nggplot(all_returns, aes(x = Return_Pct, fill = Ticker)) +\n    geom_density(alpha = 0.5) +\n    facet_wrap(~Ticker, scales = \"free_y\") +\n    labs(\n        title = \"Return Distribution Comparison\",\n        subtitle = \"All stocks show fat tails (leptokurtic distributions)\",\n        x = \"Return (%)\",\n        y = \"Density\"\n    ) +\n    scale_fill_manual(values = c(\n        \"DKNG\" = \"#006bb6\", \"PENN\" = \"darkred\",\n        \"CZR\" = \"darkgreen\", \"MGM\" = \"darkorange\"\n    )) +\n    geom_vline(xintercept = 0, linetype = \"dashed\", color = \"black\") +\n    theme_minimal() +\n    theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/return-distributions-1.png){width=1152}\n:::\n\n```{.r .cell-code}\n# Box plots\nggplot(all_returns, aes(x = Ticker, y = Return_Pct, fill = Ticker)) +\n    geom_boxplot(alpha = 0.7, outlier.alpha = 0.3) +\n    labs(\n        title = \"Return Distribution Box Plots\",\n        subtitle = \"PENN shows widest range and most extreme outliers\",\n        x = \"Stock\",\n        y = \"Return (%)\"\n    ) +\n    scale_fill_manual(values = c(\n        \"DKNG\" = \"#006bb6\", \"PENN\" = \"darkred\",\n        \"CZR\" = \"darkgreen\", \"MGM\" = \"darkorange\"\n    )) +\n    geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +\n    theme_minimal() +\n    theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](financialTS_model_files/figure-html/return-distributions-2.png){width=1152}\n:::\n:::\n\n\n\n## Correlation Analysis\n\n\n\n\n```{.r .cell-code}\n# Create wide format for correlation\nreturns_wide <- all_returns %>%\n    dplyr::select(Date, Ticker, Return_Pct) %>%\n    pivot_wider(names_from = Ticker, values_from = Return_Pct) %>%\n    dplyr::select(-Date) %>%\n    na.omit()\n\n# Correlation matrix\ncor_matrix <- cor(returns_wide)\n\n# Display formatted correlation matrix table\ncat(\"### Correlation Matrix\\n\\n\")\n```\n\n### Correlation Matrix\n\n```{.r .cell-code}\nkable(round(cor_matrix, 3),\n    format = \"html\",\n    digits = 3,\n    caption = \"Return Correlations Among Sports Betting Stocks\"\n) %>%\n    kable_styling(\n        full_width = FALSE,\n        bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\")\n    )\n```\n\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Return Correlations Among Sports Betting Stocks</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> DKNG </th>\n   <th style=\"text-align:right;\"> PENN </th>\n   <th style=\"text-align:right;\"> CZR </th>\n   <th style=\"text-align:right;\"> MGM </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> DKNG </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.499 </td>\n   <td style=\"text-align:right;\"> 0.520 </td>\n   <td style=\"text-align:right;\"> 0.379 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> PENN </td>\n   <td style=\"text-align:right;\"> 0.499 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.696 </td>\n   <td style=\"text-align:right;\"> 0.597 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> CZR </td>\n   <td style=\"text-align:right;\"> 0.520 </td>\n   <td style=\"text-align:right;\"> 0.696 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.739 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> MGM </td>\n   <td style=\"text-align:right;\"> 0.379 </td>\n   <td style=\"text-align:right;\"> 0.597 </td>\n   <td style=\"text-align:right;\"> 0.739 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n\n```{.r .cell-code}\n# Heatmap\nlibrary(reshape2)\ncor_melted <- melt(cor_matrix)\n\nggplot(cor_melted, aes(Var1, Var2, fill = value)) +\n    geom_tile(color = \"white\") +\n    geom_text(aes(label = round(value, 2)), color = \"black\", size = 5, fontface = \"bold\") +\n    scale_fill_gradient2(\n        low = \"#d1e5f0\", high = \"#006bb6\", mid = \"white\",\n        midpoint = 0, limit = c(-1, 1), space = \"Lab\",\n        name = \"Correlation\"\n    ) +\n    labs(\n        title = \"Return Correlation Heatmap\",\n        subtitle = \"Sports betting stocks show moderate to high positive correlation\",\n        x = NULL, y = NULL\n    ) +\n    theme_minimal() +\n    theme(\n        axis.text.x = element_text(angle = 45, hjust = 1, size = 11),\n        axis.text.y = element_text(size = 11),\n        plot.title = element_text(face = \"bold\")\n    )\n```\n\n![](financialTS_model_files/figure-html/correlation-analysis-1.png){width=960}\n\n\n\n**Correlation Insights**:\n\n- All stocks show **positive correlation** (0.3-0.7), indicating they respond to common industry factors\n- **CZR-MGM** show highest correlation (~0.6-0.7): both traditional casino operators\n- **DKNG-PENN** moderate correlation (~0.4-0.5): pure-play sports betting focus\n- Correlations increase during crisis periods (systematic risk)\n\n## Business Model Comparison\n\n::: {style=\"font-size: 0.9em;\"}\n\n| Stock | Business Model | Volatility Profile | Key Risks |\n|-------|---------------|-------------------|-----------|\n| **DKNG** | Pure-play online sports betting & DFS | Moderate-High | Regulatory, competition, customer acquisition costs |\n| **PENN** | Regional casinos + ESPN BET partnership | **Highest** | Business model transition, brand partnerships |\n| **CZR** | Casino operator + Caesars Sportsbook | Moderate | Debt levels, integration risks, competition |\n| **MGM** | Resort/casino + BetMGM | **Lowest** | Diversified operations reduce volatility |\n\n:::\n\n:::\n\n---\n",
    "supporting": [
      "financialTS_model_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}